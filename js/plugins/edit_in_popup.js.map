/*!
 * froala_editor v3.2.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2020 Froala Labs
 */

{"version":3,"file":"edit_in_popup.js","sources":["../../../src/js/plugins/edit_in_popup.js"],"sourcesContent":["import FE from '../index.js';\n'use strict';\n\nObject.assign(FE.DEFAULTS, {\n  editInPopup: false\n})\n\nFE.MODULES.editInPopup = function (editor) {\n  function _initPopup() {\n\n    // Image buttons.\n    const txt = `<div id=\"fr-text-edit-${editor.id}\" class=\"fr-layer fr-text-edit-layer\"><div class=\"fr-input-line\"><input type=\"text\" placeholder=\"${editor.language.translate('Text')}\" tabIndex=\"1\"></div><div class=\"fr-action-buttons\"><button type=\"button\" class=\"fr-command fr-submit\" data-cmd=\"updateText\" tabIndex=\"2\">${editor.language.translate('Update')}</button></div></div>`\n\n    const template = {\n      edit: txt\n    }\n\n    editor.popups.create('text.edit', template)\n  }\n\n  function _showPopup() {\n    const $popup = editor.popups.get('text.edit')\n\n    let text\n\n    if (editor.el.tagName === 'INPUT') {\n      text = editor.$el.attr('placeholder')\n    }\n    else {\n      text = editor.$el.text()\n    }\n\n    $popup.find('input').val(text).trigger('change')\n    editor.popups.setContainer('text.edit', editor.$sc)\n    editor.popups.show('text.edit', editor.$el.offset().left + editor.$el.outerWidth() / 2, editor.$el.offset().top + editor.$el.outerHeight(), editor.$el.outerHeight())\n  }\n\n  function _initEvents() {\n\n    // Show edit popup.\n    editor.events.$on(editor.$el, editor._mouseup, () => {\n      setTimeout(() => {\n        _showPopup()\n      }, 10)\n    })\n  }\n\n  function update() {\n    const $popup = editor.popups.get('text.edit')\n\n    let new_text = $popup.find('input').val()\n\n    if (new_text.length === 0) {\n      new_text = editor.opts.placeholderText\n    }\n\n    if (editor.el.tagName === 'INPUT') {\n      editor.$el.attr('placeholder', new_text)\n    }\n    else {\n      editor.$el.text(new_text)\n    }\n\n    editor.events.trigger('contentChanged')\n\n    editor.popups.hide('text.edit')\n  }\n\n  /**\n   * Initialize.\n   */\n  const _init = () => {\n    if (editor.opts.editInPopup) {\n      _initPopup()\n      _initEvents()\n    }\n  }\n\n  return {\n    _init,\n    update\n  }\n}\n\nFE.RegisterCommand('updateText', {\n  focus: false,\n  undo: false,\n  callback() {\n    this.editInPopup.update()\n  }\n})"],"names":["Object","assign","FE","DEFAULTS","editInPopup","MODULES","editor","_initPopup","txt","id","language","translate","template","edit","popups","create","_showPopup","$popup","get","text","el","tagName","$el","attr","find","val","trigger","setContainer","$sc","show","offset","left","outerWidth","top","outerHeight","_initEvents","events","$on","_mouseup","setTimeout","update","new_text","length","opts","placeholderText","hide","_init","RegisterCommand","focus","undo","callback"],"mappings":"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"}