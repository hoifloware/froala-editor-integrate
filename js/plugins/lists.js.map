/*!
 * froala_editor v3.2.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2020 Froala Labs
 */

{"version":3,"file":"lists.js","sources":["../../../src/js/plugins/lists.js"],"sourcesContent":["import FE from '../index.js'\n'use strict';\n\nObject.assign(FE.DEFAULTS, {\n  listAdvancedTypes: true\n})\n\nFE.PLUGINS.lists = function (editor) {\n\n  const { $ } = editor\n\n  function _openFlag(tag_name) {\n    return `<span class=\"fr-open-${tag_name.toLowerCase()}\"></span>`\n  }\n\n  function _closeFlag(tag_name) {\n    return `<span class=\"fr-close-${tag_name.toLowerCase()}\"></span>`\n  }\n\n  /**\n   * Replace list type.\n   */\n  function _replace(blocks, tag_name) {\n    const lists = []\n\n    for (let i = 0; i < blocks.length; i++) {\n      const { parentNode : parent_node } = blocks[i]\n\n      if (blocks[i].tagName == 'LI' && parent_node.tagName != tag_name && lists.indexOf(parent_node) < 0) {\n        lists.push(parent_node)\n      }\n    }\n\n    for (let i = lists.length - 1; i >= 0; i--) {\n      const $l = $(lists[i])\n      $l.replaceWith(`<${tag_name.toLowerCase()} ${editor.node.attributes($l.get(0))}>${$l.html()}</${tag_name.toLowerCase()}>`)\n    }\n  }\n\n  /**\n   * Format blocks.\n   */\n  function _format(blocks, tag_name) {\n    _replace(blocks, tag_name)\n\n    // Format those blocks that are not LI.\n    const default_tag = editor.html.defaultTag()\n\n    let start_margin = null\n\n    let prop\n\n    if (blocks.length) prop = (editor.opts.direction == 'rtl' || $(blocks[0]).css('direction') == 'rtl') ? 'margin-right' : 'margin-left'\n\n    for (let i = 0; i < blocks.length; i++) {\n\n      // Ignore table tags.\n      if (blocks[i].tagName == 'TD' || blocks[i].tagName == 'TH') {\n        continue;\n      }\n\n      if (blocks[i].tagName != 'LI') {\n\n        // Get margin left and unset it.\n        let margin_left = editor.helpers.getPX($(blocks[i]).css(prop)) || 0\n        blocks[i].style.marginLeft = null\n\n        // Start indentation relative to the first element.\n        if (start_margin === null) start_margin = margin_left\n\n        //https://github.com/froala-labs/froala-editor-js-2/issues/2435\n        // Update open tag.\n        let open_tag = start_margin > 0 ? `<${tag_name} style=\"${prop}: ${start_margin}px \">` : `<${tag_name}>`\n        let end_tag = `</${tag_name}>`\n\n        // Subsctract starting.\n        margin_left = margin_left - start_margin\n\n        // Keep wrapping.\n        while (margin_left / editor.opts.indentMargin > 0) {\n          open_tag += `</${tag_name}>`\n          end_tag += end_tag\n          margin_left = margin_left - editor.opts.indentMargin\n        }\n\n        // Default tag.\n        if (default_tag && blocks[i].tagName.toLowerCase() == default_tag) {\n          $(blocks[i]).replaceWith(`${open_tag}<li${editor.node.attributes(blocks[i])}>${$(blocks[i]).html()}</li>${end_tag}`)\n        }\n        else {\n          $(blocks[i]).wrap(`${open_tag}<li></li>${end_tag}`)\n        }\n      }\n    }\n\n    editor.clean.lists()\n  }\n\n  /**\n   * Unformat.\n   */\n  function _unformat(blocks) {\n    let i\n    let j\n\n    // If there are LI that have parents selected, then remove them.\n    for (i = blocks.length - 1; i >= 0; i--) {\n      for (j = i - 1; j >= 0; j--) {\n        if ($(blocks[j]).find(blocks[i]).length || blocks[j] == blocks[i]) {\n          blocks.splice(i, 1)\n          break\n        }\n      }\n    }\n\n    // Unwrap remaining LI.\n    const lists = []\n\n    for (i = 0; i < blocks.length; i++) {\n      const $li = $(blocks[i])\n      let { parentNode : parent_node } = blocks[i]\n      const li_class = $li.attr('class')\n\n      $li.before(_closeFlag(parent_node.tagName))\n\n      // Nested case.\n      if (parent_node.parentNode.tagName == 'LI') {\n        $li.before(_closeFlag('LI'))\n        $li.after(_openFlag('LI'))\n      }\n      else {\n        let li_attrs = ''\n\n        // https://github.com/froala/wysiwyg-editor/issues/1765 .\n        if (li_class) {\n          li_attrs += ` class=\"${li_class}\"`\n        }\n\n        const prop = (editor.opts.direction == 'rtl' || $li.css('direction') == 'rtl') ? 'margin-right' : 'margin-left'\n\n        if (editor.helpers.getPX($(parent_node).css(prop)) && ($(parent_node).attr('style') || '').indexOf(`${prop}:`) >= 0) {\n          li_attrs += ` style=\"${prop}:${editor.helpers.getPX($(parent_node).css(prop))}px;\"`\n        }\n\n        // When we have a default tag.\n        if (editor.html.defaultTag()) {\n\n          // If there are no inner block tags, put everything in a default tag.\n          if ($li.find(editor.html.blockTagsQuery()).length === 0) {\n            $li.wrapInner(editor.html.defaultTag() + li_attrs)\n          }\n        }\n\n        // Append BR if the node is not empty.\n        if (!editor.node.isEmpty($li.get(0), true) && $li.find(editor.html.blockTagsQuery()).length === 0) {\n          $li.append('<br>')\n        }\n        $li.append(_openFlag('LI'))\n        $li.prepend(_closeFlag('LI'))\n      }\n\n      $li.after(_openFlag(parent_node.tagName))\n\n      // Nested case. We should look for an upper parent.\n      if (parent_node.parentNode.tagName == 'LI') {\n        ({ parentNode : parent_node } = parent_node.parentNode );\n      }\n\n      if (lists.indexOf(parent_node) < 0) {\n        lists.push(parent_node)\n      }\n    }\n\n    // Replace the open and close tags.\n    for (i = 0; i < lists.length; i++) {\n      const $l = $(lists[i])\n      let html = $l.html()\n      html = html.replace(/<span class=\"fr-close-([a-z]*)\"><\\/span>/g, '</$1>')\n      html = html.replace(/<span class=\"fr-open-([a-z]*)\"><\\/span>/g, '<$1>')\n      $l.replaceWith(editor.node.openTagString($l.get(0)) + html + editor.node.closeTagString($l.get(0)))\n    }\n\n    // Clean empty lists.\n    editor.$el.find('li:empty').remove()\n    editor.$el.find('ul:empty, ol:empty').remove()\n\n    editor.clean.lists()\n    editor.html.wrap()\n  }\n\n  /**\n   * Check if should unformat lists.\n   */\n  function _shouldUnformat(blocks, tag_name) {\n    let do_unformat = true\n\n    for (let i = 0; i < blocks.length; i++) {\n\n      // Something else than LI is selected.\n      if (blocks[i].tagName != 'LI') {\n        return false\n      }\n\n      // There is a different kind of list selected. Replace is the appropiate action.\n      if (blocks[i].parentNode.tagName != tag_name) {\n        do_unformat = false\n      }\n    }\n\n    return do_unformat\n  }\n\n  /**\n   * Call the list actions.\n   */\n  function format(tag_name, list_type) {\n    let i\n    let blocks\n\n    editor.html.syncInputs()\n    \n    // Wrap.\n    editor.selection.save()\n    editor.html.wrap(true, true, true, true)\n    editor.selection.restore()\n\n    // Passing true to identify the call from list format\n    blocks = editor.selection.blocks(true)\n\n    // Normalize nodes by keeping the LI.\n    // <li><h1>foo<h1></li> will return h1.\n    for (i = 0; i < blocks.length; i++) {\n      if (blocks[i].tagName != 'LI' && blocks[i].parentNode.tagName == 'LI') {\n        blocks[i] = blocks[i].parentNode\n      }\n    }\n\n    // Save selection so that we can play at wish.\n    editor.selection.save()\n\n    // Decide if to format or unformat list.\n    if (_shouldUnformat(blocks, tag_name)) {\n      if (!list_type) {\n        _unformat(blocks)\n      }\n    }\n    else {\n      _format(blocks, tag_name, list_type)\n    }\n\n    // Unwrap.\n    editor.html.unwrap()\n\n    // Restore the selection.\n    editor.selection.restore()\n\n    list_type = list_type || 'default'\n\n    if (list_type) {\n      blocks = editor.selection.blocks()\n\n      for (i = 0; i < blocks.length; i++) {\n        if (blocks[i].tagName != 'LI' && blocks[i].parentNode.tagName == 'LI') {\n          blocks[i] = blocks[i].parentNode\n        }\n      }\n\n      for (i = 0; i < blocks.length; i++) {\n        // Something else than LI is selected.\n        if (blocks[i].tagName != 'LI') {\n          continue\n        }\n\n        // There is a different kind of list selected. Replace is the appropiate action.\n        $(blocks[i].parentNode).css('list-style-type', list_type === 'default' ? '' : list_type)\n\n        if (($(blocks[i].parentNode).attr('style') || '').length === 0) {\n          $(blocks[i].parentNode).removeAttr('style')\n        }\n      }\n    }\n  }\n\n  /**\n   * Refresh list buttons.\n   */\n  function refresh($btn, tag_name) {\n    const $el = $(editor.selection.element())\n\n    if ($el.get(0) != editor.el) {\n      let li = $el.get(0)\n\n      if (li.tagName != 'LI' && li.firstElementChild && li.firstElementChild.tagName != 'LI') {\n        li = $el.parents('li').get(0)\n      }\n      else if (li.tagName != 'LI' && !li.firstElementChild) {\n        li = $el.parents('li').get(0)\n      }\n      else if (li.firstElementChild && li.firstElementChild.tagName == 'LI') {\n        li = $el.get(0).firstChild\n      }\n      else {\n        li = $el.get(0)\n      }\n\n      if (li && li.parentNode.tagName == tag_name && editor.el.contains(li.parentNode)) {\n        $btn.addClass('fr-active')\n      }\n    }\n  }\n\n  /**\n   * Indent selected list items.\n   */\n  function _indent(blocks) {\n    editor.selection.save()\n\n    for (let i = 0; i < blocks.length; i++) {\n\n      // There should be a previous li.\n      const prev_li = blocks[i].previousSibling\n\n      if (prev_li) {\n        const nl = $(blocks[i]).find('> ul, > ol').last().get(0)\n\n        // Current LI has a nested list.\n        if (nl) {\n\n          // Build a new list item and prepend it to the list.\n          const $li = $(document.createElement('li'))\n          $(nl).prepend($li)\n\n          // Get first node of the list item.\n          let node = editor.node.contents(blocks[i])[0]\n\n          // While node and it is not a list, append to the new list item.\n          while (node && !editor.node.isList(node)) {\n            const tmp = node.nextSibling\n            $li.append(node)\n            node = tmp\n          }\n\n          // Append current list to the previous node.\n          $(prev_li).append($(nl))\n          $(blocks[i]).remove()\n        }\n        else {\n          const prev_nl = $(prev_li).find('> ul, > ol').last().get(0)\n\n          if (prev_nl) {\n            $(prev_nl).append($(blocks[i]))\n          }\n          else {\n            const $new_nl = $(`<${blocks[i].parentNode.tagName}>`)\n            $(prev_li).append($new_nl)\n            $new_nl.append($(blocks[i]))\n          }\n        }\n      }\n    }\n\n    editor.clean.lists()\n    editor.selection.restore()\n  }\n\n  /**\n   * Outdent selected list items.\n   */\n  function _outdent(blocks) {\n    editor.selection.save()\n    _unformat(blocks)\n    editor.selection.restore()\n  }\n\n  /**\n   * create a nested list when there is no previous sibling and make the liststyle as none\n   */\n  function _indentListStyleTypeNone(parentBlk) {\n    editor.selection.save()\n    const lst = parentBlk.tagName == 'OL' ? document.createElement('ol') : document.createElement('ul')\n    while(parentBlk.childNodes.length > 0) {\n      lst.append(parentBlk.childNodes[0])\n    }\n    const lst_parent = document.createElement('li')\n    lst_parent.style.listStyleType = 'none'\n    lst_parent.append(lst)\n    parentBlk.append(lst_parent)\n    editor.clean.lists()\n    editor.selection.restore()\n  }\n\n  function _outdentListStyleTypeNone(parentBlk) {\n    editor.selection.save()\n    while(parentBlk.childNodes.length > 0) {\n      parentBlk.parentNode.parentNode.append(parentBlk.childNodes[0])\n    }\n    editor.clean.lists()\n    editor.selection.restore()\n  }\n\n  /**\n   * Hook into the indent/outdent events.\n   */\n  function _afterCommand(cmd) {\n    if (cmd == 'indent' || cmd == 'outdent') {\n      let do_indent = false\n      const blocks = editor.selection.blocks()\n      const blks = []\n      let parentBlk = blocks[0].previousSibling || blocks[0].parentElement\n\n      if (cmd == 'outdent') {\n        //Outend is not allowed if parent is not an list\n        if (parentBlk.parentNode.tagName != 'UL' && parentBlk.parentNode.tagName != 'OL' && parentBlk.parentNode.tagName != 'LI') {\n\n          return;\n        }\n        if (!blocks[0].previousSibling && parentBlk.parentNode.style.listStyleType == 'none') {\n          _outdentListStyleTypeNone(parentBlk)\n          return\n        }\n      }\n      else {\n\n        if (!blocks[0].previousSibling || blocks[0].previousSibling.tagName != 'LI') {\n          _indentListStyleTypeNone(parentBlk)\n          return;\n        }\n      }\n\n      for (let i = 0; i < blocks.length; i++) {\n        if (blocks[i].tagName == 'LI') {\n          do_indent = true\n          blks.push(blocks[i])\n        }\n        else if (blocks[i].parentNode.tagName == 'LI') {\n          do_indent = true\n          blks.push(blocks[i].parentNode)\n        }\n      }\n\n      if (do_indent) {\n        if (cmd == 'indent') _indent(blks)\n        else _outdent(blks)\n      }\n    }\n  }\n\n  /**\n   * Init.\n   */\n  function _init() {\n    editor.events.on('commands.after', _afterCommand)\n\n    // TAB key in lists.\n    editor.events.on('keydown', function (e) {\n      if (e.which == FE.KEYCODE.TAB) {\n        const blocks = editor.selection.blocks()\n        const blks = []\n\n        for (let i = 0; i < blocks.length; i++) {\n          if (blocks[i].tagName == 'LI') {\n            blks.push(blocks[i])\n          }\n          else if (blocks[i].parentNode.tagName == 'LI') {\n            blks.push(blocks[i].parentNode)\n          }\n        }\n\n        // There is more than one list item selected.\n        // Selection is at the beginning of the selected list item.\n        if (blks.length > 1 || (blks.length && (editor.selection.info(blks[0]).atStart || editor.node.isEmpty(blks[0])))) {\n          e.preventDefault()\n          e.stopPropagation()\n\n          if (!e.shiftKey) _indent(blks)\n          else _outdent(blks)\n\n          return false\n        }\n      }\n    }, true)\n  }\n\n  return {\n    _init: _init,\n    format: format,\n    refresh: refresh\n  }\n}\n\n// Register the font size command.\nFE.DefineIcon('formatOLSimple', { NAME: 'list-ol', SVG_KEY: 'orderedList' })\nFE.RegisterCommand('formatOLSimple', {\n  title: 'Ordered List',\n  type: 'button',\n  options: {\n    'default': 'Default',\n    circle: 'Circle',\n    disc: 'Disc',\n    square: 'Square'\n  },\n  refresh: function ($btn) {\n    this.lists.refresh($btn, 'OL')\n  },\n  callback: function (cmd, param) {\n    this.lists.format('OL', param)\n  },\n  plugin: 'lists'\n})\n\n// Register the font size command.\nFE.RegisterCommand('formatUL', {\n  title: 'Unordered List',\n  type: 'button',\n  hasOptions: function () {\n    return this.opts.listAdvancedTypes\n  },\n  options: {\n    'default': 'Default',\n    circle: 'Circle',\n    disc: 'Disc',\n    square: 'Square'\n  },\n  refresh: function ($btn) {\n    this.lists.refresh($btn, 'UL')\n  },\n  callback: function (cmd, param) {\n    this.lists.format('UL', param)\n  },\n  plugin: 'lists'\n})\n\n// Register the font size command.\nFE.RegisterCommand('formatOL', {\n  title: 'Ordered List',\n  hasOptions: function () {\n    return this.opts.listAdvancedTypes\n  },\n  options: {\n    'default': 'Default',\n    'lower-alpha': 'Lower Alpha',\n    'lower-greek': 'Lower Greek',\n    'lower-roman': 'Lower Roman',\n    'upper-alpha': 'Upper Alpha',\n    'upper-roman': 'Upper Roman'\n  },\n  refresh: function ($btn) {\n    this.lists.refresh($btn, 'OL')\n  },\n  callback: function (cmd, param) {\n    this.lists.format('OL', param)\n  },\n  plugin: 'lists'\n})\n\n// Add the list icons.\nFE.DefineIcon('formatUL', {\n  NAME: 'list-ul',\n  SVG_KEY: 'unorderedList'\n})\n\nFE.DefineIcon('formatOL', {\n  NAME: 'list-ol',\n  SVG_KEY: 'orderedList'\n})\n"],"names":["Object","assign","FE","DEFAULTS","listAdvancedTypes","PLUGINS","lists","editor","$","_openFlag","tag_name","toLowerCase","_closeFlag","_replace","blocks","i","length","parent_node","parentNode","tagName","indexOf","push","$l","replaceWith","node","attributes","get","html","_format","default_tag","defaultTag","start_margin","prop","opts","direction","css","margin_left","helpers","getPX","style","marginLeft","open_tag","end_tag","indentMargin","wrap","clean","_unformat","j","find","splice","$li","li_class","attr","before","after","li_attrs","blockTagsQuery","wrapInner","isEmpty","append","prepend","replace","openTagString","closeTagString","$el","remove","_shouldUnformat","do_unformat","format","list_type","syncInputs","selection","save","restore","unwrap","removeAttr","refresh","$btn","element","el","li","firstElementChild","parents","firstChild","contains","addClass","_indent","prev_li","previousSibling","nl","last","document","createElement","contents","isList","tmp","nextSibling","prev_nl","$new_nl","_outdent","_indentListStyleTypeNone","parentBlk","lst","childNodes","lst_parent","listStyleType","_outdentListStyleTypeNone","_afterCommand","cmd","do_indent","blks","parentElement","_init","events","on","e","which","KEYCODE","TAB","info","atStart","preventDefault","stopPropagation","shiftKey","DefineIcon","NAME","SVG_KEY","RegisterCommand","title","type","options","circle","disc","square","callback","param","plugin","hasOptions"],"mappings":"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"}