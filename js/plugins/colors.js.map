/*!
 * froala_editor v3.2.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2020 Froala Labs
 */

{"version":3,"file":"colors.js","sources":["../../../src/js/plugins/colors.js"],"sourcesContent":["import FE from '../index.js'\n'use strict';\n\n// Popup templates for both textColor and backgroundColor\nObject.assign(FE.POPUP_TEMPLATES, {\n  'textColor.picker': '[_BUTTONS_][_TEXT_COLORS_][_CUSTOM_COLOR_]',\n  'backgroundColor.picker': '[_BUTTONS_][_BACKGROUND_COLORS_][_CUSTOM_COLOR_]'\n})\n\n// Extend defaults.\nObject.assign(FE.DEFAULTS, {\n  colorsText: [\n    '#61BD6D', '#1ABC9C', '#54ACD2', '#2C82C9', '#9365B8', '#475577', '#CCCCCC',\n    '#41A85F', '#00A885', '#3D8EB9', '#2969B0', '#553982', '#28324E', '#000000',\n    '#F7DA64', '#FBA026', '#EB6B56', '#E25041', '#A38F84', '#EFEFEF', '#FFFFFF',\n    '#FAC51C', '#F37934', '#D14841', '#B8312F', '#7C706B', '#D1D5D8', 'REMOVE'\n  ],\n  colorsBackground: [\n    '#61BD6D', '#1ABC9C', '#54ACD2', '#2C82C9', '#9365B8', '#475577', '#CCCCCC',\n    '#41A85F', '#00A885', '#3D8EB9', '#2969B0', '#553982', '#28324E', '#000000',\n    '#F7DA64', '#FBA026', '#EB6B56', '#E25041', '#A38F84', '#EFEFEF', '#FFFFFF',\n    '#FAC51C', '#F37934', '#D14841', '#B8312F', '#7C706B', '#D1D5D8', 'REMOVE'\n  ],\n  colorsStep: 7,\n  colorsHEXInput: true,\n  colorsButtons: ['colorsBack', '|', '-']\n})\n\nFE.PLUGINS.colors = function (editor) {\n\n  const { $ } = editor\n  const custom_color_template = `<div class=\"fr-color-hex-layer fr-active fr-layer\" id=\"fr-color-hex-layer- \n  ${editor.id}\"><div class=\"fr-input-line\"><input maxlength=\"7\" id=\"[ID]\"\n  type=\"text\" placeholder=\"${editor.language.translate('HEX Color')}\" \n  tabIndex=\"1\" aria-required=\"true\"></div><div class=\"fr-action-buttons\"><button \n  type=\"button\" class=\"fr-command fr-submit\" data-cmd=\"[COMMAND]\" tabIndex=\"2\" role=\"button\">\n  ${editor.language.translate('OK')}</button></div></div>`\n\n  /*\n   * Show the colors popup.\n   */\n  function _showColorsPopup(cmd_type) {\n    const $btn = editor.$tb.find(`.fr-command[data-cmd=\"${cmd_type}\"]`)\n\n    // Get color picker based on command type\n    let $popup = editor.popups.get(`${cmd_type}.picker`) \n\n    if (!$popup) $popup = _initColorsPopup(cmd_type)\n\n    if (!$popup.hasClass('fr-active')) {\n\n      // Colors popup\n      editor.popups.setContainer(`${cmd_type}.picker`, editor.$tb)\n\n      // Refresh colors in the current popup\n      if (cmd_type === 'textColor') {\n        _refreshColor('text')\n      }\n      else {\n        _refreshColor('background')\n      }\n\n      // Colors popup left and top position.\n      if ($btn.isVisible()) {\n        const { left, top } = editor.button.getPosition($btn)\n        editor.popups.show(`${cmd_type}.picker`, left, top, $btn.outerHeight())\n      }\n      else {\n        editor.position.forSelection($popup)\n        editor.popups.show(`${cmd_type}.picker`)\n      }\n    }\n  }\n\n  /**\n   * Init the colors popup.\n   */\n  function _initColorsPopup(cmd_type) {\n    \n    let colors_buttons = ''\n    \n    if (editor.opts.toolbarInline) {\n\n      // Colors buttons.\n      if (editor.opts.colorsButtons.length > 0) {\n        colors_buttons += `<div class=\"fr-buttons fr-colors-buttons fr-tabs\">\n        ${editor.button.buildList(editor.opts.colorsButtons)}\n        </div>`\n      }\n    }\n\n    // Custom HEX.\n    let custom_color = ''\n\n    let template\n    if (cmd_type === 'textColor') {\n\n      if (editor.opts.colorsHEXInput) {\n        custom_color = custom_color_template.replace(/\\[ID\\]/g, `fr-color-hex-layer-text-${editor.id}`)\n          .replace(/\\[COMMAND\\]/g, 'customTextColor')\n      }\n\n      // Template for textColor picker\n      template = {\n        buttons: colors_buttons,\n        text_colors: _colorPickerHTML('text'),\n        custom_color: custom_color\n      }\n    } \n    else {\n\n      if (editor.opts.colorsHEXInput) {\n        custom_color = custom_color_template.replace(/\\[ID\\]/g, `fr-color-hex-layer-background-${editor.id}`)\n          .replace(/\\[COMMAND\\]/g, 'customBackgroundColor')\n      }\n\n      // Template for backgroundColor picker\n      template = {\n        buttons: colors_buttons,\n        background_colors: _colorPickerHTML('background'),\n        custom_color: custom_color\n      }\n    }\n    // Create a popup and add accessibility to it\n    let $popup = editor.popups.create(`${cmd_type}.picker`, template)\n    _addAccessibility($popup, `${cmd_type}.picker`)\n\n    return $popup\n  }\n\n  /*\n   * HTML for the color picker colors.\n   */\n  function _colorPickerHTML(tab) {\n\n    // Get colors according to tab name.\n    const colors = (tab === 'text' ? editor.opts.colorsText : editor.opts.colorsBackground)\n\n    // Create colors html.\n    let colors_html = `<div class=\"fr-color-set fr-${tab}-color fr-selected-set\">`\n\n    // Add colors.\n    for (let i = 0; i < colors.length; i++) {\n      if (i !== 0 && i % editor.opts.colorsStep === 0) {\n        colors_html += '<br>'\n      }\n\n      if (colors[i] !== 'REMOVE') {\n        colors_html += `<span class=\"fr-command fr-select-color\" style=\"background:${colors[i]};\" \n        tabIndex=\"-1\" aria-selected=\"false\" role=\"button\" data-cmd=\"apply${tab}Color\" \n        data-param1=\"${colors[i]}\"><span class=\"fr-sr-only\"> ${editor.language.translate('Color')}${colors[i]} \n        &nbsp;&nbsp;&nbsp;</span></span>`\n      }\n\n      else {\n        colors_html += `<span class=\"fr-command fr-select-color\" data-cmd=\"apply${tab}Color\"\n         tabIndex=\"-1\" role=\"button\" data-param1=\"REMOVE\" \n         title=\"${editor.language.translate('Clear Formatting')}\">${editor.icon.create('remove')} \n        <span class=\"fr-sr-only\"> ${editor.language.translate('Clear Formatting')} </span></span>`\n      }\n    }\n\n    return `${colors_html}</div>`\n  }\n\n  /*\n   * Register keyboard events.\n   */\n  function _addAccessibility($popup, popupName) {\n\n    // Register popup event.\n    editor.events.on('popup.tab', function (e) {\n      const $focused_item = $(e.currentTarget)\n\n      // Skip if popup is not visible or focus is elsewere.\n      if (!editor.popups.isVisible(popupName) || !$focused_item.is('span')) {\n        return true\n      }\n      const key_code = e.which\n      let status = true\n\n      // Tabbing.\n      if (FE.KEYCODE.TAB === key_code) {\n        const $tb = $popup.find('.fr-buttons')\n\n        // Focus back the popup's toolbar if exists.\n        status = !editor.accessibility.focusToolbar($tb, (e.shiftKey ? true : false))\n      }\n\n      // Arrows.\n      else if (FE.KEYCODE.ARROW_UP === key_code || FE.KEYCODE.ARROW_DOWN === key_code \n        || FE.KEYCODE.ARROW_LEFT === key_code || FE.KEYCODE.ARROW_RIGHT === key_code) {\n        if ($focused_item.is('span.fr-select-color')) {\n\n          // Get all current colors.\n          const $colors = $focused_item.parent().find('span.fr-select-color')\n\n          // Get focused item position.\n          const index = $colors.index($focused_item)\n\n          // Get color matrix dimensions.\n          const columns = editor.opts.colorsStep\n          const lines = Math.floor($colors.length / columns)\n\n          // Get focused item coordinates.\n          const column = index % columns\n          const line = Math.floor(index / columns)\n\n          let nextIndex = line * columns + column\n          const dimension = lines * columns\n\n          // Calculate next index. Go to the other opposite site of the matrix if there is no next adjacent element.\n          // Up/Down: Traverse matrix lines.\n          // Left/Right: Traverse the matrix as it is a vector.\n          if (FE.KEYCODE.ARROW_UP === key_code) {\n            nextIndex = (((nextIndex - columns) % dimension) + dimension) % dimension // Javascript negative modulo bug.\n          }\n          else if (FE.KEYCODE.ARROW_DOWN === key_code) {\n            nextIndex = (nextIndex + columns) % dimension\n          }\n          else if (FE.KEYCODE.ARROW_LEFT === key_code) {\n            nextIndex = (((nextIndex - 1) % dimension) + dimension) % dimension // Javascript negative modulo bug.\n          }\n          else if (FE.KEYCODE.ARROW_RIGHT === key_code) {\n            nextIndex = (nextIndex + 1) % dimension\n          }\n\n          // Get the next element based on the new index.\n          const $el = $($colors.get(nextIndex))\n\n          // Focus.\n          editor.events.disableBlur()\n          $el.focus()\n\n          status = false\n        }\n      }\n\n      // ENTER or SPACE.\n      else if (FE.KEYCODE.ENTER === key_code) {\n\n        editor.button.exec($focused_item)\n        status = false\n      }\n\n      // Prevent propagation.\n      if (status === false) {\n        e.preventDefault()\n        e.stopPropagation()\n      }\n\n      return status\n    }, true)\n  }\n\n  /*\n   * Show the current selected color.\n   */\n  function _refreshColor(tab) {\n    const $popup = editor.popups.get(`${tab}Color.picker`)\n    let $element = $(editor.selection.element())\n\n    // The color css property.\n    let color_type\n\n    if (tab === 'background') {\n      color_type = 'background-color'\n    }\n    else {\n      color_type = 'color'\n    }\n\n    const $current_color = $popup.find(`.fr-${tab}-color .fr-select-color`)\n\n    // Remove current color selection.\n\n    $current_color.find('.fr-selected-color').remove()\n    $current_color.removeClass('fr-active-item')\n    $current_color.not('[data-param1=\"REMOVE\"]').attr('aria-selected', false)\n\n    // Find the selected color.\n    while ($element.get(0) !== editor.el) {\n\n      // Transparent or black.\n      if ($element.css(color_type) === 'transparent' || $element.css(color_type) === 'rgba(0, 0, 0, 0)') {\n        $element = $element.parent()\n      }\n\n      // Select the correct color.\n      else {\n        const $select_color = $popup.find(`.fr-${tab}-color .fr-select-color[data-param1=\"${editor.helpers.RGBToHex($element.css(color_type))}\"]`)\n\n        // Add checked icon.\n        $select_color.append('<span class=\"fr-selected-color\" aria-hidden=\"true\">\\uf00c</span>')\n        $select_color.addClass('fr-active-item').attr('aria-selected', true)\n        break\n      }\n    }\n\n    _updateColor(tab)\n  }\n\n  function _updateColor(val) {\n    const $popup = editor.popups.get(`${val}Color.picker`)\n    let $selectionColor = $popup.find(`.fr-${val}-color .fr-active-item`).attr('data-param1')\n    const $input = $popup.find('.fr-color-hex-layer input')\n\n    if (!$selectionColor) {\n      $selectionColor = ''\n    }\n\n    if ($input.length) {\n      $($input.val($selectionColor).input).trigger('change')\n    }\n  }\n\n  /*\n   * Change background color.\n   */\n  function background(val) {\n\n    // Set background  color.\n    if (val !== 'REMOVE') {\n      editor.format.applyStyle('background-color', editor.helpers.HEXtoRGB(val))\n    }\n\n    // Remove background color.\n    else {\n      editor.format.removeStyle('background-color')\n    }\n\n    editor.popups.hide('backgroundColor.picker')\n  }\n\n  /*\n   * Change text color.\n   */\n  function text(val) {\n\n    // Set text color.\n    if (val !== 'REMOVE') {\n      editor.format.applyStyle('color', editor.helpers.HEXtoRGB(val))\n    }\n\n    // Remove text color.\n    else {\n      editor.format.removeStyle('color')\n    }\n\n    editor.popups.hide('textColor.picker')\n  }\n\n  /*\n   * Go back to the inline editor.\n   */\n  function back() {\n    editor.popups.hide('textColor.picker')\n    editor.popups.hide('backgroundColor.picker')\n    editor.toolbar.showInline()\n  }\n\n  function customColor(tab) {\n    const $popup = editor.popups.get(`${tab}Color.picker`)\n\n    const $input = $popup.find('.fr-color-hex-layer input')\n\n    if ($input.length) {\n      const color = $input.val()\n\n      // Set custom color\n      if (tab === 'background') {\n        background(color)\n      }\n      else {\n        text(color)\n      }\n    }\n  }\n\n  return {\n    showColorsPopup: _showColorsPopup,\n    background: background,\n    customColor: customColor,\n    text: text,\n    back: back\n  }\n}\n\n// Select text color command.\nFE.DefineIcon('textColor', { NAME: 'tint', SVG_KEY: 'textColor' })\nFE.RegisterCommand('textColor', {\n  title: 'Text Color',\n  undo: false,\n  focus: true,\n  refreshOnCallback: false,\n  popup: true,\n  callback: function () {\n    if (!this.popups.isVisible('textColor.picker')) {\n      this.colors.showColorsPopup('textColor')\n    }\n    else {\n      if (this.$el.find('.fr-marker').length) {\n        this.events.disableBlur()\n        this.selection.restore()\n      }\n      this.popups.hide('textColor.picker')\n    }\n  }\n})\n// Command to apply text color from the available colors\nFE.RegisterCommand('applytextColor', {\n  undo: true,\n  callback: function (cmd, val) {\n    this.colors.text(val)\n  }\n})\n// Command to set custom text color\nFE.RegisterCommand('customTextColor', {\n  title: 'OK',\n  undo: true,\n  callback: function () {\n    this.colors.customColor('text')\n  }\n})\n\n// Select background color command.\nFE.DefineIcon('backgroundColor', { NAME: 'paint-brush', SVG_KEY: 'backgroundColor' })\nFE.RegisterCommand('backgroundColor', {\n  title: 'Background Color',\n  undo: false,\n  focus: true,\n  refreshOnCallback: false,\n  popup: true,\n  callback: function () {\n    if (!this.popups.isVisible('backgroundColor.picker')) {\n      this.colors.showColorsPopup('backgroundColor')\n    }\n    else {\n      if (this.$el.find('.fr-marker').length) {\n        this.events.disableBlur()\n        this.selection.restore()\n      }\n      this.popups.hide('backgroundColor.picker')\n    }\n  }\n})\n// Command to apply background color from the available colors\nFE.RegisterCommand('applybackgroundColor', {\n  undo: true,\n  callback: function (cmd, val) {\n    this.colors.background(val)\n  }\n})\n// Command to set custom background color\nFE.RegisterCommand('customBackgroundColor', {\n  title: 'OK',\n  undo: true,\n  callback: function () {\n    this.colors.customColor('background')\n  }\n})\n\n// Colors back.\nFE.DefineIcon('colorsBack', { NAME: 'arrow-left', SVG_KEY: 'back' })\nFE.RegisterCommand('colorsBack', {\n  title: 'Back',\n  undo: false,\n  focus: false,\n  back: true,\n  refreshAfterCallback: false,\n  callback: function () {\n    this.colors.back()\n  }\n})\n\nFE.DefineIcon('remove', { NAME: 'eraser', SVG_KEY: 'remove' })\n"],"names":["Object","assign","FE","POPUP_TEMPLATES","DEFAULTS","colorsText","colorsBackground","colorsStep","colorsHEXInput","colorsButtons","PLUGINS","colors","editor","$","custom_color_template","id","language","translate","_showColorsPopup","cmd_type","$btn","$tb","find","$popup","popups","get","_initColorsPopup","hasClass","setContainer","_refreshColor","isVisible","button","getPosition","left","top","show","outerHeight","position","forSelection","colors_buttons","opts","toolbarInline","length","buildList","custom_color","template","replace","buttons","text_colors","_colorPickerHTML","background_colors","create","_addAccessibility","tab","colors_html","i","icon","popupName","events","on","e","$focused_item","currentTarget","is","key_code","which","status","KEYCODE","TAB","accessibility","focusToolbar","shiftKey","ARROW_UP","ARROW_DOWN","ARROW_LEFT","ARROW_RIGHT","$colors","parent","index","columns","lines","Math","floor","column","line","nextIndex","dimension","$el","disableBlur","focus","ENTER","exec","preventDefault","stopPropagation","$element","selection","element","color_type","$current_color","remove","removeClass","not","attr","el","css","$select_color","helpers","RGBToHex","append","addClass","_updateColor","val","$selectionColor","$input","input","trigger","background","format","applyStyle","HEXtoRGB","removeStyle","hide","text","back","toolbar","showInline","customColor","color","showColorsPopup","DefineIcon","NAME","SVG_KEY","RegisterCommand","title","undo","refreshOnCallback","popup","callback","restore","cmd","refreshAfterCallback"],"mappings":"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"}